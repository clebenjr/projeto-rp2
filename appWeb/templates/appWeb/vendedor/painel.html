{% extends "base.html" %}

{% block title %}Meu Perfil{% endblock %}

{% block header %}
<header class="app-header">
    <!-- √çcone de menu (3 tracinhos) -->
    <button onclick="toggleMenu()"
            style="background:none; border:none; color:white; font-size:22px; margin-left:10px; cursor:pointer;">
        ‚ò∞
    </button>
    <h1>Perfil</h1>
    <span style="width:22px;"></span>
</header>
{% endblock %}

{% block content %}

    {# ============== MENU LATERAL + OVERLAY ============== #}
    <!-- Menu lateral -->
    <div id="side-menu"
         style="
            position: fixed;
            top: 0;
            left: -260px;
            width: 260px;
            height: 100%;
            background: #4b3840;
            color: white;
            padding: 20px;
            transition: left 0.3s ease;
            z-index: 9999;
         ">
        <h2 style="margin-top: 0; font-size: 18px;">Menu</h2>

        <a href="{% url 'logout' %}"
           style="display:block; margin-top:20px; color:white; text-decoration:none; font-size:16px;">
            üîê Logout
        </a>
    </div>

    <!-- Fundo escuro quando o menu est√° aberto -->
    <div id="menu-overlay"
         onclick="toggleMenu()"
         style="
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.4);
            display:none;
            z-index: 9998;
         ">
    </div>

    {# ============== CONTE√öDO DO PERFIL ============== #}

    <div style="display:flex; justify-content:center; margin-top:16px; margin-bottom:8px;">
    {% if vendedor.foto_perfil %}
        <img src="{{ vendedor.foto_perfil.url }}"
             alt="Foto de {{ vendedor.nome_venda }}"
             class="avatar-perfil">
    {% else %}
        <div class="avatar-perfil avatar-placeholder"></div>
    {% endif %}
    </div>

    <div class="profile-name">
        {{ vendedor.nome_venda }}
    </div>

    <div style="margin-top:6px; text-align:center;">
        {% if vendedor.status_disponivel %}
            <span style="color:#28a745; font-weight:600; font-size:14px;">
                Dispon√≠vel
            </span>
        {% else %}
            <span style="color:#d9534f; font-weight:600; font-size:14px;">
                Indispon√≠vel
            </span>
        {% endif %}
    </div>


    <div class="profile-location">
        {{ vendedor.local_principal_venda|default:"Local n√£o informado" }}
    </div>

    <div style="margin-top:16px;">
        <a href="{% url 'editar_perfil' %}" class="btn-primary" style="text-decoration:none;">
            Editar Perfil
        </a>
    </div>

    <div class="products-section-title">
        Produtos √† venda
    </div>

    {% for produto in produtos %}
        <div class="product-card">
            <div class="product-image"
                 style="{% if produto.imagem %}background-image:url('{{ produto.imagem.url }}');{% endif %}">
            </div>
            <div class="product-info">
                <div class="product-name">{{ produto.nome }}</div>
            </div>
            <div class="product-price">
                R$ {{ produto.preco }}
            </div>
        </div>
    {% empty %}
        <p style="font-size:14px; color:#777;">Voc√™ ainda n√£o cadastrou produtos.</p>
    {% endfor %}

    <!-- Bot√£o flutuante para editar cat√°logo -->
    <a href="{% url 'listar_produtos' %}" class="fab" title="Editar cat√°logo">
        ‚úèÔ∏è
    </a>

    <script>
    function toggleMenu() {
        const menu = document.getElementById("side-menu");
        const overlay = document.getElementById("menu-overlay");

        if (menu.style.left === "0px") {
            menu.style.left = "-260px";
            overlay.style.display = "none";
        } else {
            menu.style.left = "0px";
            overlay.style.display = "block";
        }
    }
    </script>

{% endblock %}
